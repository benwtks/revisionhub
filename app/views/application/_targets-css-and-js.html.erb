<script>
  $(document).on("turbolinks:before-cache", function() {
    <% subjects.each do |subject| %>
      $('<%= j ".target.#{subject.hyphenated_name}" %>').removeClass('animated-target');
    <% end %>
  });
  $(document).on("turbolinks:load", function() {
    <% subjects.each do |subject| %>
      $('<%= j ".target.#{subject.hyphenated_name}" %>').addClass('animated-target');
    <% end %>
  });
</script>

<style>
  <% subjects.each do |subject| %>
    .target.<%= subject.hyphenated_name %>.animated-target circle.ui-filled{
      stroke-dashoffset: 324.75;
      animation: <%= "target-load-#{subject.hyphenated_name}" %> 1s forwards linear;
    }

    @keyframes target-load-<%= subject.hyphenated_name %> {
      from {
        stroke-dashoffset: 400;
      }
      to {
        stroke-dashoffset: <%= subject.target_amount_to_offset * 324.75 %>;
      }
    }
  <% end %>
</style>
