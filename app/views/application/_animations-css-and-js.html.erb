<script>
  var subjects = <%= j subjects.map{|x| x[:name].join(",") %>

  $(document).on("turbolinks:before-cache", function() {
    $(subjects).removeClass('animated-target');
  });
  $(document).on("turbolinks:load", function() {
    $(subjects).addClass('animated-target');
  });
  $(document).on("turbolinks:render", function() {
    $('.top').removeClass('initial-animate');
  });
</script>

<style>
  <% subjects.each do |subject| %>
    .target.<%= subject.hyphenated_name %>.animated-target circle.ui-filled{
      stroke-dashoffset: 324.75;
      animation: <%= "target-load-#{subject.hyphenated_name}" %> 1s forwards linear;
    }

    @keyframes target-load-<%= subject.hyphenated_name %> {
      from {
        stroke-dashoffset: 400;
      }
      to {
        stroke-dashoffset: <%= subject.target_amount_to_offset * 324.75 %>;
      }
    }
  <% end %>
</style>
